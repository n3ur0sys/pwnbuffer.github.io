<!DOCTYPE html>
<html lang="pt-br">

<head>
  <title>
  Privilege Escalation no Linux ¬∑ pwnbuffer
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="pwnbuffer">
<meta name="description" content="Um artigo sobre t√©cnicas de escalonamento de privil√©gios em ambientes Linux">
<meta name="keywords" content="hack the planet!">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Privilege Escalation no Linux">
  <meta name="twitter:description" content="Um artigo sobre t√©cnicas de escalonamento de privil√©gios em ambientes Linux">

<meta property="og:url" content="https://pwnbuffer.org/posts/slayer/privesc-linux/">
  <meta property="og:site_name" content="pwnbuffer">
  <meta property="og:title" content="Privilege Escalation no Linux">
  <meta property="og:description" content="Um artigo sobre t√©cnicas de escalonamento de privil√©gios em ambientes Linux">
  <meta property="og:locale" content="pt_br">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-03-22T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-03-22T00:00:00+00:00">
    <meta property="article:tag" content="Privilege Escalation">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Exploitation">
    <meta property="article:tag" content="Post-Exploitation">




<link rel="canonical" href="https://pwnbuffer.org/posts/slayer/privesc-linux/">


<link rel="preload" href="https://pwnbuffer.org/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://pwnbuffer.org/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://pwnbuffer.org/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="https://pwnbuffer.org/css/coder.min.b886fe0d9034709648f91f4ce178f51dd367d9350f82dd1132d54fd69bfca66f.css" integrity="sha256-uIb&#43;DZA0cJZI&#43;R9M4Xj1HdNn2TUPgt0RMtVP1pv8pm8=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="https://pwnbuffer.org/css/coder-dark.min.165f5fe7c98269a5cfc54f81472e0f84ebc32d92bbe6c9db1f06962b0817bda1.css" integrity="sha256-Fl9f58mCaaXPxU&#43;BRy4PhOvDLZK75snbHwaWKwgXvaE=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="https://pwnbuffer.org/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="https://pwnbuffer.org/img/favicon-32x32.ico" sizes="32x32">
<link rel="icon" type="image/png" href="https://pwnbuffer.org/img/favicon-16x16.ico" sizes="16x16">

<link rel="apple-touch-icon" href="https://pwnbuffer.org/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://pwnbuffer.org/images/apple-touch-icon.png">

<link rel="manifest" href="https://pwnbuffer.org/site.webmanifest">
<link rel="mask-icon" href="https://pwnbuffer.org/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-dark">
  

  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://pwnbuffer.org/">
      pwnbuffer
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/about/">Sobre</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/posts/">Artigos</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/categories/">Categorias</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/members/">Membros</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/contribute/">Contribua</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="https://pwnbuffer.org/wallpapers/">Wallpapers</a>
            </li>
          
        
        
          
          
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="https://pwnbuffer.org/en/posts/slayer/privesc-linux/">üá∫üá∏</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://pwnbuffer.org/posts/slayer/privesc-linux/">
              Privilege Escalation no Linux
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2025-03-22T00:00:00Z">
                mar√ßo 22, 2025
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              14 minutos de leitura
            </span>
          </div>
          <div class="authors">
  <i class="fa-solid fa-user" aria-hidden="true"></i>
    <a href="https://pwnbuffer.org/authors/slayer/">Slayer</a></div>

          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="https://pwnbuffer.org/categories/hacking/">Hacking</a>
      <span class="separator">‚Ä¢</span>
    <a href="https://pwnbuffer.org/categories/linux/">Linux</a>
      <span class="separator">‚Ä¢</span>
    <a href="https://pwnbuffer.org/categories/vulnerability-exploitation/">Vulnerability-Exploitation</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="https://pwnbuffer.org/tags/privilege-escalation/">Privilege Escalation</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="https://pwnbuffer.org/tags/linux/">Linux</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="https://pwnbuffer.org/tags/exploitation/">Exploitation</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="https://pwnbuffer.org/tags/post-exploitation/">Post-Exploitation</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p><strong>Ol√°, eu sou o Slayer. Neste paper, irei falar sobre a escalada de privil√©gios no Linux. Recomendo que, enquanto l√™ este paper, tamb√©m v√° testando as t√©cnicas na pr√°tica, pois isso ajudar√° a entender melhor os conceitos e a aplicar os conhecimentos adquiridos de forma mais eficaz.</strong></p>
<h1 id="introdu√ß√£o">
  Introdu√ß√£o
  <a class="heading-link" href="#introdu%c3%a7%c3%a3o">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h1>
<p><strong>Escala√ß√£o de privil√©gios √© o processo de obter n√≠veis mais altos de acesso ou controle em um sistema do que o originalmente permitido. Em sistemas Linux, isso geralmente envolve a eleva√ß√£o de um usu√°rio comum para privil√©gios de root ou a explora√ß√£o de permiss√µes mal configuradas para acessar recursos restritos. Essa t√©cnica √© amplamente utilizada em ataques para comprometer sistemas e estender o alcance de uma invas√£o.</strong></p>
<p><strong>Escalar privil√©gios pode ocorrer de diferentes formas, seja para obter maior controle dentro do mesmo n√≠vel de acesso ou para atingir n√≠veis mais altos de privil√©gio, como o root. No pr√≥ximo t√≥pico, vamos detalhar as diferen√ßas entre a escala√ß√£o horizontal e vertical.</strong></p>
<h2 id="escala√ß√£o-horizontal-x-escala√ß√£o-vertical">
  Escala√ß√£o Horizontal X Escala√ß√£o Vertical
  <a class="heading-link" href="#escala%c3%a7%c3%a3o-horizontal-x-escala%c3%a7%c3%a3o-vertical">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>A escala√ß√£o horizontal ocorre quando um atacante ganha acesso √†s contas ou permiss√µes de outro usu√°rio no mesmo n√≠vel de privil√©gio, como um colega de trabalho em uma rede corporativa. J√° a escala√ß√£o vertical envolve a obten√ß√£o de permiss√µes mais altas, como a de um administrador ou root, permitindo controle total sobre o sistema. Ambos os m√©todos podem ser usados em conjunto para explorar diferentes camadas de um ambiente.</strong></p>
<h2 id="conceitos-fundamentais">
  Conceitos Fundamentais
  <a class="heading-link" href="#conceitos-fundamentais">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>Feita a introdu√ß√£o, antes de come√ßar a escalar privil√©gios, √© √≥bvio que voc√™ deve conhecer pelo menos os conceitos b√°sicos e fundamentais do Linux, como o funcionamento de permiss√µes de arquivos, grupos e usu√°rios, estrutura de pastas, configura√ß√£o do sistema, etc. Se voc√™ n√£o tem esse conhecimento b√°sico sobre Linux, n√£o perca o seu tempo lendo este paper.</strong></p>
<h1 id="privesc-techniques-misconfigs">
  PrivEsc Techniques (misconfigs)
  <a class="heading-link" href="#privesc-techniques-misconfigs">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h1>
<h3 id="suid-files">
  SUID Files
  <a class="heading-link" href="#suid-files">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>Arquivos com a permiss√£o SUID (Set User ID) permitem que o processo gerado pelo arquivo seja executado com as permiss√µes do propriet√°rio, n√£o do usu√°rio que o executa. Isso pode ser uma grande vulnerabilidade se arquivos SUID forem mal configurados, pois qualquer usu√°rio comum pode obter privil√©gios elevados ao executar esses arquivos. Um exemplo cl√°ssico seria um arquivo SUID pertencente ao root que, se mal configurado ou com vulnerabilidades, poderia ser explorado por um atacante para obter acesso de root. Comandos como &ldquo;find&rdquo; podem ser usadas para localizar arquivos SUID em um sistema e verificar se h√° arquivos vulner√°veis.</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-0-0:checked ~ .tab-content-0-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-0" id="tab-0-0" checked/>
<label for="tab-0-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-0-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>find / -perm /4000 2&gt;/dev/null
</span></span></code></pre></div>
</div>




</div>



<p><strong>Este comando por exemplo, busca a partir do diret√≥rio raiz arquivos com a permiss√£o SUID ativada.</strong></p>
<h3 id="sudo-with-misconfig">
  Sudo With Misconfig
  <a class="heading-link" href="#sudo-with-misconfig">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>O arquivo de configura√ß√£o do sudo define quem pode executar comandos como root e quais comandos podem ser executados. Uma configura√ß√£o incorreta pode permitir que um usu√°rio execute comandos com privil√©gios elevados sem autentica√ß√£o adequada. Para verificar a configura√ß√£o de sudo, use:</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-1-0:checked ~ .tab-content-1-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-1" id="tab-1-0" checked/>
<label for="tab-1-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-1-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo cat /etc/sudoers
</span></span></code></pre></div>
</div>




</div>



<p><strong>Se o arquivo sudoers permitir a execu√ß√£o de comandos como root sem senha, ou se um usu√°rio comum tiver permiss√µes excessivas, isso pode ser explorado para escalar privil√©gios! (Obs: Lembrando que o arquivo &ldquo;/etc/sudoers&rdquo; por padr√£o s√≥ pode ser modificado e lido pelo root!)</strong></p>
<h3 id="crontabs-with-misconfig">
  Crontabs With Misconfig
  <a class="heading-link" href="#crontabs-with-misconfig">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>Crontabs s√£o usados para agendar tarefas autom√°ticas. Se um crontab for mal configurado, com permiss√µes excessivas, um atacante pode modificar o cron job para executar comandos arbitr√°rios com privil√©gios elevados. Para verificar crontabs, execute:</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-2-0:checked ~ .tab-content-2-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-2" id="tab-2-0" checked/>
<label for="tab-2-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-2-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>crontab -l
</span></span></code></pre></div>
</div>




</div>



<p><strong>Al√©m disso, a verifica√ß√£o de crontabs do sistema pode ser feita inspecionando os arquivos em /etc/cron.d/ e /var/spool/cron/crontabs!</strong></p>
<h1 id="privesc-techniques-vulnerabilities">
  PrivEsc Techniques (Vulnerabilities)
  <a class="heading-link" href="#privesc-techniques-vulnerabilities">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h1>
<h3 id="kernel-exploits">
  Kernel exploits
  <a class="heading-link" href="#kernel-exploits">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>Vulnerabilidades no kernel Linux permitem que atacantes elevem privil√©gios explorando falhas na l√≥gica de sistemas cr√≠ticos. Duas das mais famosas s√£o:</strong></p>
<p><strong><a href="https://dirtycow.ninja/"  class="external-link" target="_blank" rel="noopener">Dirty COW (CVE-2016-5195)</a>: Essa vulnerabilidade ocorre devido a uma condi√ß√£o de corrida na implementa√ß√£o de c√≥pia sob grava√ß√£o (Copy-On-Write) no kernel Linux. Isso permite que um atacante com acesso de grava√ß√£o a um arquivo, mesmo que protegido, modifique seu conte√∫do. Por exemplo, um arquivo de configura√ß√£o cr√≠tico como /etc/passwd pode ser alterado para adicionar um usu√°rio root.</strong></p>
<p><strong><a href="https://www.hackthebox.com/blog/Dirty-Pipe-Explained-CVE-2022-0847"  class="external-link" target="_blank" rel="noopener">Dirty Pipe (CVE-2022-0847)</a>: Similar ao Dirty COW, mas espec√≠fico a sistemas com kernels mais recentes. Ele explora falhas na manipula√ß√£o de buffers em pipelines do Linux. Um atacante pode injetar dados em arquivos de leitura somente, como os logs do sistema, para executar comandos maliciosos. O processo de explora√ß√£o envolve a manipula√ß√£o de dados no n√≠vel do buffer de leitura.</strong></p>
<p><strong>Ambas as vulnerabilidades requerem um exploit espec√≠fico, que pode ser encontrado em bases como o <a href="https://www.exploit-db.com/"  class="external-link" target="_blank" rel="noopener">Exploit-DB</a>.</strong></p>
<h3 id="root-services">
  Root Services
  <a class="heading-link" href="#root-services">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>Servi√ßos rodando como root representam um dos maiores riscos de seguran√ßa em sistemas Linux, pois qualquer vulnerabilidade nesses servi√ßos pode ser explorada para obter privil√©gios elevados. O fato de um servi√ßo rodar com privil√©gios de root significa que ele tem acesso irrestrito ao sistema, podendo modificar arquivos cr√≠ticos, executar comandos privilegiados e, em muitos casos, comprometer a integridade do sistema inteiro. Por isso, √© fundamental que apenas os servi√ßos realmente necess√°rios para o funcionamento do sistema sejam executados com esses privil√©gios, e que eles sejam configurados corretamente.</strong></p>
<p><strong>Muitos servi√ßos, especialmente servidores web, bancos de dados e servidores de arquivos, frequentemente rodam como root para realizar opera√ß√µes espec√≠ficas que exigem acesso a recursos restritos. Um exemplo cl√°ssico √© o servidor web nginx ou apache, que pode precisar acessar diret√≥rios ou arquivos com permiss√µes restritas, como logs ou arquivos de configura√ß√£o do sistema. Se um desses servi√ßos for mal configurado, um atacante pode explorar falhas para injetar c√≥digo malicioso, obter acesso ao sistema ou at√© mesmo escalar privil√©gios.</strong></p>
<p><strong>Uma das formas mais comuns de explora√ß√£o de servi√ßos que rodam como root √© a RCE. Isso ocorre quando um atacante consegue fazer com que o servi√ßo execute comandos arbitr√°rios no sistema, geralmente aproveitando vulnerabilidades como buffer overflows, falhas de valida√ß√£o de entrada ou autentica√ß√£o inadequada. Um atacante pode, por exemplo, enviar uma solicita√ß√£o maliciosa para um servidor web que permita a execu√ß√£o de um script arbitr√°rio. Se esse servidor estiver rodando como root, o atacante pode ganhar controle total sobre o sistema, podendo criar backdoors para acessos futuros. Para identificar quais processos est√£o rodando como root, voc√™ pode executar:</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-3-0:checked ~ .tab-content-3-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-3" id="tab-3-0" checked/>
<label for="tab-3-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-3-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ps aux | grep root
</span></span></code></pre></div>
</div>




</div>



<h3 id="dynamic-libraries">
  Dynamic Libraries
  <a class="heading-link" href="#dynamic-libraries">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>A explora√ß√£o de bibliotecas din√¢micas √© uma t√©cnica usada para alterar o comportamento de programas leg√≠timos, fazendo com que eles carreguem e executem c√≥digo malicioso. Essa t√©cnica se baseia no funcionamento do sistema Linux, que permite que programas carreguem bibliotecas externas durante sua execu√ß√£o. As vari√°veis de ambiente LD_PRELOAD e LD_LIBRARY_PATH s√£o essenciais nesse processo, pois controlam a ordem em que as bibliotecas s√£o carregadas.</strong></p>
<p><strong>A t√©cnica mais comum de explora√ß√£o envolve a vari√°vel LD_PRELOAD. Quando um programa √© executado com essa vari√°vel configurada, o sistema carrega uma biblioteca especificada antes de qualquer outra biblioteca do sistema. Isso significa que, ao manipular essa vari√°vel, √© poss√≠vel fazer com que o programa execute fun√ß√µes de uma biblioteca diferente da original. Por exemplo, pode-se substituir fun√ß√µes como system(), execve() ou setuid() para modificar o comportamento do programa, permitindo que a√ß√µes indesejadas sejam realizadas, como a execu√ß√£o de comandos com privil√©gios elevados.</strong></p>
<p><strong>Esse tipo de explora√ß√£o acontece quando um programa, especialmente aqueles que possuem permiss√µes elevadas, n√£o valida adequadamente as vari√°veis de ambiente. Isso permite que, ao manipular a vari√°vel LD_PRELOAD, uma biblioteca maliciosa seja carregada antes do programa original. A partir da√≠, a biblioteca pode sobrescrever fun√ß√µes importantes do programa, permitindo, por exemplo, a execu√ß√£o de comandos no sistema sem que o programa leg√≠timo perceba.</strong></p>
<p><strong>Como exemplo, imagine que um programa use a fun√ß√£o system() para executar comandos. Se ele n√£o limpar as vari√°veis de ambiente antes de fazer isso, voc√™ pode criar uma biblioteca maliciosa que modifica a execu√ß√£o dessa fun√ß√£o, fazendo com que comandos sejam executados com privil√©gios de root. Isso pode ser feito criando uma biblioteca que substitui a fun√ß√£o setuid() para alterar o ID de usu√°rio do programa e conceder acesso total ao sistema.</strong></p>
<p><strong>Outra forma de explora√ß√£o acontece com a vari√°vel LD_LIBRARY_PATH, que especifica os diret√≥rios onde o sistema procura por bibliotecas. Se um programa confiar nesse caminho de busca de maneira insegura, √© poss√≠vel manipular a vari√°vel para apontar para uma vers√£o maliciosa de uma biblioteca. Isso faz com que o programa utilize uma vers√£o comprometida da biblioteca, que pode executar a√ß√µes prejudiciais ao sistema.</strong></p>
<p><strong>Al√©m disso, existe a possibilidade de library hijacking, onde uma vers√£o maliciosa de uma biblioteca √© colocada em um diret√≥rio onde o sistema espera encontrar bibliotecas. Se o programa procurar por uma biblioteca nesse diret√≥rio, acabar√° usando a vers√£o modificada, o que permite que o c√≥digo malicioso seja executado.</strong></p>
<p><strong>Hoje em dia, algumas medidas de seguran√ßa podem dificultar esses ataques, como a configura√ß√£o do ld.so para bloquear a manipula√ß√£o de LD_PRELOAD em programas com permiss√µes elevadas ou o uso de recursos como o ASLR, que torna mais dif√≠cil para um invasor prever onde as bibliotecas ser√£o carregadas na mem√≥ria. No entanto, se n√£o forem tomadas as precau√ß√µes corretas, a explora√ß√£o de bibliotecas din√¢micas ainda pode ser uma t√©cnica eficaz para obter acesso root a sistemas.</strong></p>
<h3 id="command-injection">
  Command Injection
  <a class="heading-link" href="#command-injection">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>O command injection ocorre quando um script, que √© executado com privil√©gios como root, n√£o valida adequadamente as entradas fornecidas, permitindo que comandos maliciosos sejam inseridos e executados. Isso pode acontecer em scripts de automa√ß√£o, como backups ou limpeza de arquivos, que aceitam entradas de usu√°rios sem a devida verifica√ß√£o.</strong></p>
<p><strong>Por exemplo, um script de backup que recebe um diret√≥rio como argumento pode ser manipulado para executar um comando malicioso, como:</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-4-0:checked ~ .tab-content-4-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-4" id="tab-4-0" checked/>
<label for="tab-4-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-4-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>./backup.sh <span style="color:#008900">&#34;/home/user; id&#34;</span>
</span></span></code></pre></div>
</div>




</div>



<p><strong>A principal causa dessa vulnerabilidade √© o uso de fun√ß√µes como eval ou system, que executam comandos diretamente, sem validar as entradas.</strong></p>
<h3 id="path-hijacking">
  Path Hijacking
  <a class="heading-link" href="#path-hijacking">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>O Path Hijacking ocorre quando um invasor manipula o caminho de busca de execut√°veis no sistema (usando a vari√°vel de ambiente PATH) para for√ßar o sistema a executar um arquivo malicioso em vez de um execut√°vel leg√≠timo. Isso pode ser feito adicionando diret√≥rios controlados pelo atacante ao in√≠cio da vari√°vel PATH, fazendo com que os programas procurem e executem vers√µes comprometidas de bin√°rios ou scripts.</strong></p>
<p><strong>Por exemplo, se o atacante conseguir alterar a vari√°vel PATH para incluir um diret√≥rio onde um bin√°rio malicioso foi colocado, o sistema pode acabar executando esse bin√°rio ao inv√©s do original. Suponha que um script ou comando tente rodar um programa como ls ou cat. Se o diret√≥rio contendo um bin√°rio malicioso de ls ou cat for listado antes do diret√≥rio padr√£o, o sistema ir√° executar o bin√°rio malicioso, que pode conter c√≥digo para obter privil√©gios elevados ou executar comandos maliciosos.</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-5-0:checked ~ .tab-content-5-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-5" id="tab-5-0" checked/>
<label for="tab-5-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-5-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#ec0000">export</span> <span style="color:#ec0000">PATH</span><span style="color:#ec0000">=</span>/path/malicious:<span style="color:#ec0000">$PATH</span>
</span></span></code></pre></div>
</div>




</div>



<p><strong>Isso pode permitir que o atacante execute comandos sem que o sistema execute as vers√µes leg√≠timas desses programas.</strong></p>
<h1 id="privesc-techniques-credentialstokens">
  PrivEsc Techniques (Credentials/Tokens)
  <a class="heading-link" href="#privesc-techniques-credentialstokens">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h1>
<h3 id="theft-of-hashespasswords">
  Theft Of Hashes/Passwords
  <a class="heading-link" href="#theft-of-hashespasswords">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>O roubo de hashes e senhas ocorre quando um atacante consegue acessar e extrair os hashes de senhas armazenados em arquivos como o /etc/shadow no Linux. O arquivo /etc/shadow armazena as senhas criptografadas (em forma de hashes) dos usu√°rios do sistema. Se um atacante conseguir acessar esse arquivo, ele pode tentar quebrar os hashes e obter as senhas originais.</strong></p>
<p><strong>Normalmente, as senhas no Linux s√£o armazenadas de forma criptografada, utilizando algoritmos como MD5, SHA-512 ou bcrypt. Por√©m, esses algoritmos de hash n√£o s√£o revers√≠veis, ou seja, n√£o √© poss√≠vel recuperar diretamente a senha original a partir do hash. No entanto, com a extra√ß√£o do hash, um atacante pode usar t√©cnicas como brute force ou rainbow tables para tentar adivinhar a senha original.</strong></p>
<p><strong>Por exemplo, se o atacante conseguir ler o arquivo /etc/shadow, que cont√©m as senhas dos usu√°rios, ele pode usar ferramentas como o Jo√£o o Estuprador (John the Ripper) ou Hashcat para tentar quebrar os hashes e obter as senhas. O comando abaixo pode ser usado para extrair as senhas de um arquivo /etc/shadow:</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-6-0:checked ~ .tab-content-6-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-6" id="tab-6-0" checked/>
<label for="tab-6-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-6-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo cat /etc/shadow | grep user
</span></span></code></pre></div>
</div>




</div>



<p><strong>Isso revela o hash da senha do usu√°rio especificado. A partir da√≠, o atacante pode tentar adivinhar a senha atrav√©s de ataques de for√ßa bruta ou usando tabelas pr√© computadas! (Obs: Novamente dizendo o obvio, o /etc/shadow normalmente s√≥ pode ser acessado pelo root.)</strong></p>
<h3 id="keyloggers--sniffers">
  Keyloggers &amp; Sniffers
  <a class="heading-link" href="#keyloggers--sniffers">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h3>
<p><strong>Keyloggers e sniffers s√£o ferramentas usadas para capturar credenciais, explorando diferentes pontos do sistema. Enquanto keyloggers monitoram e registram tudo o que √© digitado pelo teclado, sniffers interceptam e analisam o tr√°fego de rede para extrair informa√ß√µes sens√≠veis, como nomes de usu√°rios e senhas.</strong></p>
<p><strong>Keyloggers podem ser implementados como software ou hardware. No caso de software, eles se integram ao S.O para registrar entradas do teclado. Um keylogger pode ser instalado em um sistema comprometido por meio de malwares, engenharia social ou acesso f√≠sico. Uma vez ativo, ele registra tudo o que o usu√°rio digita, incluindo credenciais usadas para login, acessos a servi√ßos banc√°rios e outros dados sens√≠veis.</strong></p>
<p><strong>Por exemplo, um keylogger simples pode ser implementado como um LKM que intercepta chamadas de sistema relacionadas ao teclado. Isso pode ser feito no Linux manipulando dispositivos como /dev/input/ para capturar as teclas pressionadas. O log gerado pelo keylogger pode ser armazenado localmente ou enviado para um servidor remoto.</strong></p>
<p><strong>J√° sniffers trabalham interceptando pacotes de dados que trafegam pela rede. Eles s√£o especialmente eficazes em redes n√£o criptografadas, onde as informa√ß√µes sens√≠veis, como credenciais, podem ser capturadas em texto puro. Ferramentas como Tubar√£o de Fio (Wireshark) ou tcpdump s√£o usadas para capturar e analisar pacotes. Por exemplo, em uma rede desprotegida, um invasor pode usar um comando como:</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-7-0:checked ~ .tab-content-7-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-7" id="tab-7-0" checked/>
<label for="tab-7-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-7-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>tcpdump -i eth0 -A port <span style="color:#008900">80</span>
</span></span></code></pre></div>
</div>




</div>



<p><strong>Esse comando captura tr√°fego HTTP (n√£o criptografado) na interface de rede eth0, onde credenciais enviadas em formul√°rios podem ser interceptadas.</strong></p>
<h1 id="automatic-tools">
  Automatic Tools
  <a class="heading-link" href="#automatic-tools">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h1>
<h2 id="linpeashttpsgithubcompeass-ngpeass-ng">
  <a href="https://github.com/peass-ng/PEASS-ng"  class="external-link" target="_blank" rel="noopener">LinPEAS</a>
  <a class="heading-link" href="#linpeashttpsgithubcompeass-ngpeass-ng">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>O LinPEAS (Linux Privilege Escalation Awesome Script) √© uma ferramenta de auditoria que automatiza a busca por vetores de escala√ß√£o de privil√©gios em sistemas Linux. Ele analisa o sistema em busca de vulnerabilidades, como configura√ß√µes inseguras, arquivos SUID, permiss√µes incorretas, servi√ßos mal configurados e muito mais. O LinPEAS √© amplamente utilizado por sua abordagem detalhada e abrangente.</strong></p>
<h2 id="linux-exploit-suggesterhttpsgithubcomthe-z-labslinux-exploit-suggester">
  <a href="https://github.com/The-Z-Labs/linux-exploit-suggester"  class="external-link" target="_blank" rel="noopener">Linux Exploit Suggester</a>
  <a class="heading-link" href="#linux-exploit-suggesterhttpsgithubcomthe-z-labslinux-exploit-suggester">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>O Linux Exploit Suggester √© uma ferramenta que identifica poss√≠veis vulnerabilidades do kernel Linux no sistema alvo. Baseando-se na vers√£o do kernel, ele sugere exploits conhecidos que podem ser usados para obter privil√©gios elevados. √â especialmente √∫til para determinar exploits espec√≠ficos que podem ser aplicados ao sistema.</strong></p>
<h2 id="gtfobinshttpsgtfobinsgithubio">
  <a href="https://gtfobins.github.io/"  class="external-link" target="_blank" rel="noopener">GTFOBins</a>
  <a class="heading-link" href="#gtfobinshttpsgtfobinsgithubio">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>O GTFOBins √© uma cole√ß√£o de bin√°rios Unix que podem ser explorados para escalar privil√©gios, executar comandos, ou escapar de ambientes restritos, como chroot ou containers. A plataforma oferece uma base de dados online e permite buscar por bin√°rios espec√≠ficos e os m√©todos de explora√ß√£o associados. √â uma ferramenta indispens√°vel para pentesters e pesquisadores de seguran√ßa.</strong></p>
<h1 id="useful-tools">
  Useful Tools
  <a class="heading-link" href="#useful-tools">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h1>
<h2 id="strace">
  Strace
  <a class="heading-link" href="#strace">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>O strace √© uma ferramenta que permite rastrear syscalls feitas por um processo em execu√ß√£o. Ele √© amplamente utilizado para depura√ß√£o e an√°lise de comportamento de programas. Ao observar as syscalls, √© poss√≠vel identificar intera√ß√µes com arquivos, redes, ou at√© vulnerabilidades em bin√°rios mal projetados.</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-8-0:checked ~ .tab-content-8-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-8" id="tab-8-0" checked/>
<label for="tab-8-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-8-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>strace -o output.txt ./programa
</span></span></code></pre></div>
</div>




</div>



<h2 id="ltrace">
  Ltrace
  <a class="heading-link" href="#ltrace">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>O ltrace √© semelhante ao strace, mas foca no rastreamento de chamadas a bibliotecas din√¢micas (como libc). Ele √© √∫til para observar intera√ß√µes com fun√ß√µes como printf, malloc, ou chamadas espec√≠ficas a bibliotecas externas, que podem revelar vulnerabilidades ou comportamentos inesperados.</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-9-0:checked ~ .tab-content-9-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-9" id="tab-9-0" checked/>
<label for="tab-9-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-9-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ltrace ./programa
</span></span></code></pre></div>
</div>




</div>



<h2 id="gdb">
  Gdb
  <a class="heading-link" href="#gdb">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>O gdb (GNU Debugger) √© uma ferramenta poderosa para depura√ß√£o de programas. Ele permite analisar a execu√ß√£o de um bin√°rio em tempo real, inspecionar a mem√≥ria, modificar registradores, ou at√© mesmo explorar vulnerabilidades como buffer overflows.</strong></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-10-0:checked ~ .tab-content-10-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-10" id="tab-10-0" checked/>
<label for="tab-10-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-10-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>gdb ./programa
</span></span></code></pre></div>
</div>




</div>



<p><strong>Com isso, voc√™ entra no ambiente interativo do gdb, onde pode definir breakpoints, analisar o fluxo do programa e explorar vulnerabilidades.</strong></p>
<h1 id="task-automation">
  Task automation
  <a class="heading-link" href="#task-automation">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h1>
<h2 id="lineumhttpsgithubcomrebootuserlinenum">
  <a href="https://github.com/rebootuser/LinEnum"  class="external-link" target="_blank" rel="noopener">LinEum</a>
  <a class="heading-link" href="#lineumhttpsgithubcomrebootuserlinenum">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>O LinEnum √© um script que automatiza a coleta de informa√ß√µes de sistemas Linux para identificar poss√≠veis vetores de escala√ß√£o de privil√©gios. Ele verifica permiss√µes, arquivos sens√≠veis, bin√°rios SUID, crontabs e muito mais, economizando tempo em auditorias manuais.</strong></p>
<h2 id="pspyhttpsgithubcomdominicbreukerpspy">
  <a href="https://github.com/DominicBreuker/pspy"  class="external-link" target="_blank" rel="noopener">PSPY</a>
  <a class="heading-link" href="#pspyhttpsgithubcomdominicbreukerpspy">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>O pspy √© uma ferramenta leve que monitora processos em execu√ß√£o no sistema sem precisar de permiss√µes elevadas. Ele √© √∫til para identificar scripts, tarefas cron ou servi√ßos sendo executados que podem ser explorados.</strong></p>
<h2 id="chiselhttpsgithubcomjpillorachisel">
  <a href="https://github.com/jpillora/chisel"  class="external-link" target="_blank" rel="noopener">Chisel</a>
  <a class="heading-link" href="#chiselhttpsgithubcomjpillorachisel">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link para o cabe√ßalho"></i>
    <span class="sr-only">Link para o cabe√ßalho</span>
  </a>
</h2>
<p><strong>O Chisel √© uma ferramenta de tunelamento reverso e redirecionamento de portas. Ele √© √∫til para estabelecer conex√µes entre m√°quinas comprometidas e o atacante, especialmente em ambientes onde o acesso √† rede √© restrito.</strong></p>
<p><strong>Exemplo de uso:</strong></p>
<p><em>No atacante (modo servidor):</em></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-11-0:checked ~ .tab-content-11-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-11" id="tab-11-0" checked/>
<label for="tab-11-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-11-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>chisel server -p <span style="color:#008900">8000</span> --reverse
</span></span></code></pre></div>
</div>




</div>



<p><em>Na m√°quina comprometida (modo cliente):</em></p>





<div class="tabs tabs-code tabs-left">
  




<style>
  .tabs input#tab-12-0:checked ~ .tab-content-12-0 {
    display: block;
  }
</style>

<input type="radio" class="tab-input" name="tab-select-12" id="tab-12-0" checked/>
<label for="tab-12-0" class="tab-label">Bash</label>
<div class="tab-content tab-content-12-0">
  <div class="highlight"><pre tabindex="0" style="color:#757575;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>chisel client ip <span style="color:#ec0000">do</span> atacante:8000 R:8000:localhost:22
</span></span></code></pre></div>
</div>




</div>



<p><strong>Esse comando redireciona a porta 22 (normalmente a SSH) da m√°quina comprometida para o atacante!</strong></p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script>
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ¬©
    
    2025
     pwnbuffer 
    ¬∑
    
    Promovido por <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder (modified)</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="https://pwnbuffer.org/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
